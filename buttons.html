<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All the Fishes</title>
    <script src="https://pixijs.download/release/pixi.js"></script>
</head>
<body>

<script type="module">

    // The App
    const app = new PIXI.Application();
    await app.init({
        width:640,
        height:480,
        backgroundColor: 0x000000
    });

    // Add view to the body
    document.body.appendChild(app.canvas);

    // Expose the app to the document
    window.app = app;

    // Button
    /* let button = new PIXI.Graphics()
        button.beginFill(0xCCCCCC)
        button.drawRect(0, 0 , 100, 50)
        button.endFill()

        button.interactive = true

        button.on("pointerover", (event) => {
            console.log("Pointer")
            console.log(event.client.x, event.client.y)
        })

    app.stage.addChild(button) */

    // Button
    class Button extends PIXI.Container {

        constructor(pos_x, pos_y, text = "Label", width = 100, height = 50) {
            super()

            let body = new PIXI.Graphics()
                body.beginFill(0xCCCCCC)
                body.drawRect(pos_x, pos_y, width, height)
                body.endFill()

            this.addChild(body)
            this.body = body
            
            // Label
            let label = new PIXI.Text(text)
                label.anchor.set(.5)
                label.x = (body.width / 2) + pos_x
                label.y = (body.height / 2) + pos_y

            this.addChild(label)

            this.interactive = true
        }

    }

    let ourButton = new Button(100, 100, "Click Me!", 200, 100)
        ourButton.on("pointerover", () => { // hover over
            ourButton.alpha = .5
        })
        ourButton.on("pointerout", () => { // hover out
            ourButton.alpha = 1
        })
        ourButton.on("pointerdown", () => { // click down
            ourButton.body.tint = 0xFF0000
        })
        ourButton.on("pointerupoutside", () => { // let go outside of button
            ourButton.body.tint = 0xFFFFFF
        })

    app.stage.addChild(ourButton)

    let ourButton2 = new Button(350, 100, "Drag Me!", 200, 100)
        let buttonDragged = false

        ourButton2.on("pointerdown", () => {
            buttonDragged = true
        })
        ourButton2.on("pointerup", () => {
            buttonDragged = false
        })
        ourButton2.on("pointermove", (event) => {
            console.log(event)
            if (buttonDragged == false) return

            ourButton2.x = event.client.x - ourButton2.body.width / 2
            ourButton2.y = event.client.y - ourButton2.body.height / 2

            console.log(ourButton2, event)
        })

    app.stage.addChild(ourButton2)

</script>
    
</body>
</html>